<view class="pay-wraps"><view class="pay-main"><view class="pay-location disFlex"><view class="location-img"><image src="/static/location.png"></image></view><view class="location-main"><view class="location-person">{{''+orderinfo.address_name}}<text class="location-phone">{{orderinfo.address_phone}}</text></view><view class="location-text marginTop20">{{''+orderinfo.address+" "+orderinfo.address_detail+''}}</view></view><view class="location-edit"></view></view><view class="pay-item"><view class="pay-title">订单信息</view><block wx:for="{{orderinfo.goods_data}}" wx:for-item="data" wx:for-index="index" wx:key="index"><view class="pay-text"><view class="text-img"><image src="{{data.cover}}"></image></view><view class="text-intr"><view class="intr-name line2">{{''+data.goods_name+''}}</view><view class="intr-norm"><view class="intr-norm1">{{'规格:'+data.goods_attr_name+''}}</view></view></view><block wx:if="{{orderinfo.order_type==3&&orderinfo.is_tail_money==0}}"><view class="text-price"><text class="symbol">￥</text>{{goodsMoney+''}}<view class="text-num">{{'x'+data.goods_num+''}}</view></view></block><block wx:else><view class="text-price"><text class="symbol">￥</text>{{data.goods_price+''}}<view class="text-num">{{'x'+data.goods_num+''}}</view></view></block></view></block><block wx:if="{{orderinfo.order_type==3&&orderinfo.paytype==2&&nowtime<tailstart}}"><view class="pay-status"><view class="status-title">等待尾款支付开始</view><view class="status-intr">{{'尾款：'+orderinfo.tail_starttime+" - "+orderinfo.tail_endtime+''}}</view></view></block><block wx:if="{{orderinfo.order_type==3&&orderinfo.paytype==2&&nowtime>=tailstart&&nowtime<=tailend}}"><view class="pay-status"><view class="status-title">等待买家付尾款</view><view class="status-intr">{{'请于'+day+"天"+hr+"时"+min+"分"+sec+'秒内付尾款，超时订单将自动关闭'}}</view></view></block><block wx:if="{{orderinfo.order_type==3}}"><view class="pay-fare pay-common"><view class="pay-left-common">发货时间</view><block wx:if="{{orderinfo.delivery_type==1}}"><view class="pay-right-common">{{orderinfo.delivery_time+"开始发货"}}</view></block><block wx:if="{{orderinfo.delivery_type==2}}"><view class="pay-right-common">{{orderinfo.delivery_day+"内发货"}}</view></block></view></block><view class="pay-fare pay-common"><view class="pay-left-common">运费</view><view class="pay-right-common">{{"总计 ￥"+orderinfo.freightprice}}</view></view><block wx:if="{{orderinfo.order_type==1}}"><view class="pay-card pay-common"><view class="pay-left-common">现金券</view><view class="pay-right-common pay-right-witch">{{"现金券抵扣"+(cashMoney||0)+"元"}}</view><image src="/static/to-right.png" data-event-opts="{{[['tap',[['show',['QSPopupTicket']]]]]}}" bindtap="__e"></image></view></block><block wx:if="{{orderinfo.order_type==3&&orderinfo.is_tail_money==0&&orderinfo.paytype==2}}"><view class="pay-card pay-common"><view class="pay-left-common">现金券</view><view class="pay-right-common pay-right-witch">{{"现金券抵扣"+(cashMoney||0)+"元"}}</view><image src="/static/to-right.png" data-event-opts="{{[['tap',[['show',['QSPopupTicket']]]]]}}" bindtap="__e"></image></view></block><view class="pay-remarks pay-common"><view class="pay-left-common">订单编号</view><view class="pay-right-common">{{orderinfo.ordernum}}</view></view><view class="pay-remarks pay-common"><view class="pay-left-common">备注</view><view class="pay-right-common"><input type="text" placeholder="选填，请先和商家协商一致" data-event-opts="{{[['input',[['__set_model',['','buycontent','$event',[]]]]]]}}" value="{{buycontent}}" bindinput="__e"/></view></view><block wx:if="{{orderinfo.order_type==3&&orderinfo.is_tail_money==0}}"><view><block wx:if="{{orderinfo.paytype==2}}"><view><view class="pay-subtotal pay-subtotal-advance"><text>阶段1：定金<text class="pay-intr">(已付)</text></text><text class="subtotal-price"><text class="symbol">￥</text>{{readyMoney}}</text></view><view class="pay-subtotal pay-subtotal-advance"><block wx:if="{{nowtime<tailstart}}"><text>阶段2：尾款<text class="pay-intr">(未开始)</text></text></block><block wx:if="{{nowtime>=tailstart&&nowtime<=tailend}}"><text>阶段2：尾款<text class="pay-intr">(等待支付)</text></text></block><block wx:if="{{nowtime>tailend}}"><text>阶段2：尾款<text class="pay-intr">(已超时)</text></text></block><text class="subtotal-price"><text class="symbol">￥</text>{{tailMoney}}</text></view></view></block><block wx:else><view><view class="pay-subtotal pay-subtotal-advance"><text>阶段1：定金</text><text class="subtotal-price"><text class="symbol">￥</text>{{readyMoney}}</text></view><view class="pay-subtotal pay-subtotal-advance"><text>阶段2：尾款</text><text class="subtotal-price"><text class="symbol">￥</text>{{tailMoney}}</text></view></view></block></view></block><block wx:else><view><view class="pay-subtotal"><text>小计：</text><text class="subtotal-price"><text class="symbol">￥</text>{{orderinfo.totalprice}}</text></view></view></block></view></view><block wx:if="{{orderinfo.order_type==3&&orderinfo.paytype==2&&nowtime<tailstart}}"><view class="pay-ffooter-up">{{'尾款时间：'+orderinfo.tail_starttime+" - "+orderinfo.tail_endtime+''}}</view></block><block wx:if="{{orderinfo.order_type==3&&orderinfo.paytype==2&&nowtime>=tailstart&&nowtime<=tailend}}"><view class="pay-ffooter-up">{{'请于'+day+"天"+hr+"时"+min+"分"+sec+'秒内付尾款，超时订单将自动关闭'}}</view></block><block wx:if="{{orderinfo.order_type==3&&orderinfo.is_tail_money==0&&orderinfo.paytype==2&&nowtime>=tailstart&&nowtime<=tailend}}"><view data-event-opts="{{[['tap',[['show',['QSPopupChoose',4]]]]]}}" class="pay-ffooter" bindtap="__e">支付尾款</view></block><block wx:else><block wx:if="{{orderinfo.order_type==3&&orderinfo.is_tail_money==0&&orderinfo.paytype==2&&nowtime<tailstart}}"><view class="pay-ffooter pay-ffooter-gray">支付尾款</view></block><block wx:else><block wx:if="{{orderinfo.order_type==3&&orderinfo.is_tail_money==0&&orderinfo.paytype==2&&nowtime>tailend}}"><view class="pay-ffooter pay-ffooter-gray">支付尾款</view></block><block wx:else><block wx:if="{{orderinfo.order_type==3&&orderinfo.is_tail_money==0}}"><view class="pay-footer"><view data-event-opts="{{[['tap',[['show',['QSPopupChoose',1]]]]]}}" class="pay-footer-l" bindtap="__e">支付定金</view><view data-event-opts="{{[['tap',[['show',['QSPopupChoose',2]]]]]}}" class="pay-footer-r" bindtap="__e">全款购买</view></view></block><block wx:else><view class="pay-footer"><view class="pay-text">实付金额：<text class="pay-price"><text class="symbol">￥</text>{{totalMoneys}}</text></view><view data-event-opts="{{[['tap',[['show',['QSPopupChoose',2]]]]]}}" class="pay-btn" bindtap="__e">支付订单</view></view></block></block></block></block><q-s-popup class="vue-ref" vue-id="fbd4c838-1" type="fadeInUp" data-ref="QSPopupTicket" bind:__l="__l" vue-slots="{{['default']}}"><view class="ticket"><block wx:if="{{cashList.length>0}}"><view class="ticket-main"><view class="ticket-title">优惠券<image class="close-out" src="/static/out.png" data-event-opts="{{[['tap',[['hides',['QSPopupTicket']]]]]}}" bindtap="__e"></image></view><block wx:for="{{cashList}}" wx:for-item="item" wx:for-index="i" wx:key="i"><view class="ticket-item"><view class="{{['ticket-space',item.is_available==0?'ticket-gray':'']}}"><view class="ticket-price">￥<text>{{item.money}}</text>现金券</view><text class="ticket-intr">{{'订单金额满 '+item.at_least+" 可使用  \n  有效期"+item.start_time+" -- "+item.end_time+''}}</text></view><block wx:if="{{item.is_available==1}}"><view class="ticket-select"><block wx:if="{{item.checked}}"><image class="select-img" src="{{selectImg}}" data-event-opts="{{[['tap',[['selectedCash',['$0',i],[[['cashList','',i]]]]]]]}}" bindtap="__e"></image></block><block wx:else><image class="select-img" src="{{unSelectImg}}" data-event-opts="{{[['tap',[['selectedCash',['$0',i],[[['cashList','',i]]]]]]]}}" bindtap="__e"></image></block></view></block></view></block></view></block><block wx:else><view class="nodata">暂无优惠券~</view></block><view data-event-opts="{{[['tap',[['useCash',['$event']]]]]}}" class="sure-btn" bindtap="__e">确定</view></view></q-s-popup><q-s-popup class="vue-ref" vue-id="fbd4c838-2" type="fadeInUp" data-ref="QSPopupChoose" bind:__l="__l" vue-slots="{{['default']}}"><view class="choosepay"><view class="choose-title">支付订单<image src="/static/out.png" data-event-opts="{{[['tap',[['hides',['QSPopupChoose']]]]]}}" bindtap="__e"></image></view><view class="choose-price"><text class="symbol">￥</text><text>{{totalMoney}}</text></view><block wx:for="{{chooseList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['choose',['$0',index],[[['chooseList','',index]]]]]]]}}" class="choose-item" bindtap="__e"><view class="choose-item-l"><image src="{{item.src}}"></image>{{''+item.name+''}}</view><view class="choose-item-r"><image class="select-img" src="{{item.checked?selectImg:unSelectImg}}" data-event-opts="{{[['tap',[['choose',['$0',index],[[['chooseList','',index]]]]]]]}}" bindtap="__e"></image></view></view></block><view data-event-opts="{{[['tap',[['payOrder',['$event']]]]]}}" class="sure-btn" bindtap="__e">确认支付</view></view></q-s-popup><q-s-popup class="vue-ref" vue-id="fbd4c838-3" data-ref="QSPopupSuccess" bind:__l="__l" vue-slots="{{['default']}}"><view class="success"><image src="/static/pay-success.png"></image>支付成功</view></q-s-popup><block wx:if="{{isPay}}"><keyboard-pay vue-id="fbd4c838-4" payMoney="{{totalMoney}}" payTitle="{{cashTitle}}" source="{{source}}" data-event-opts="{{[['^payCode',[['getPayCode']]],['^closeModal',[['closePayModal']]]]}}" bind:payCode="__e" bind:closeModal="__e" bind:__l="__l"></keyboard-pay></block></view>