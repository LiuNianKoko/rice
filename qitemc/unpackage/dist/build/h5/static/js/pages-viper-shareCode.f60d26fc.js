(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-viper-shareCode"],{"0bfd":function(t,e,i){"use strict";var a=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf");var o=a(i("1da1")),n=a(i("8cc3")),s=a(i("8af5")),r=a(i("a75e")),d=getApp(),c={data:function(){return{imag:d.globalData.imag,codeImg:"",bgImg:"",windowWidth:0,windowHeight:0,base64:null,poster:{},qrShow:!1,canvasId:"default_PosterCanvasId",hids:!1,downloadPic:""}},components:{QSPopup:s.default},onLoad:function(){this.getCode()},onShareAppMessage:function(t){var e=this;return{title:"扫一扫注册",path:"/pages/index/index",imageUrl:e.codeImg}},methods:{back:function(){uni.navigateBack({delta:1})},show:function(t){this.$refs[t].show()},hides:function(t){this.$refs[t].hide()},getCode:function(){var t=this,e={token:uni.getStorageSync("token")};(0,n.default)("/api/user/qrcode","post",e).then((function(e){"200"==e.data.status&&(t.codeImg=e.data.data.qrcode,t.bgImg=e.data.data.share),console.log(e)}))},showHids:function(){this.hids=!0},hidsctx:function(){this.hids=!1},shareF:function(){var t=this;t.hids=!0;var e="";e=this.codeImg?this.codeImg:t.imag+"twocode-bg.jpg",setTimeout((function(){var i=uni.createCanvasContext("firstCanvas");i.beginPath(),i.drawImage(t.imag+"15.jpg",0,0,270,400),i.rotate(73*Math.PI/180),i.drawImage(e,214,-115,110,110),i.closePath(),i.draw(!1,(function(){t.$util.showLoading("请稍后，正在生成..."),setTimeout((function(){uni.canvasToTempFilePath({x:0,y:0,width:270,height:400,fileType:"png",quality:1,canvasId:"firstCanvas",success:function(e){console.log("1212",e),t.downloadPic=e.tempFilePath,t.$util.hideLoading(),"canvasToTempFilePath:ok"==e.errMsg&&t.downs()},fail:function(t){console.log(t)}})}),500)}))}))},downs:function(){var t=this;console.log(t.downloadPic),uni.saveImageToPhotosAlbum({filePath:t.downloadPic,success:function(e){console.log("3443",e),uni.showToast({title:"保存成功"}),setTimeout((function(){t.hids=!1}),1e3)},fail:function(t){uni.showToast({title:"保存失败",icon:"none"}),console.log(t)}})},shareFc:function(){var t=this;return(0,o.default)(regeneratorRuntime.mark((function e(){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t,e.prev=1,i.poster.finalPath){e.next=8;break}return e.next=5,(0,r.default)({type:"testShareType",backgroundImage:i.bgImg,posterCanvasId:i.canvasId,qrCodeArray:function(t){var e=t.bgObj;t.type,t.bgScale;return[{text:"",size:.01*e.width,dx:.1*e.width-999,dy:e.height-.1*e.width}]},imagesArray:function(t){var e=t.bgObj,a=(t.type,t.bgScale,.3*e.width);return[{url:i.codeImg,dx:a,dy:e.height-.9*e.width,dWidth:240,dHeight:240}]},textArray:function(t){var e=t.bgObj;t.type,t.bgScale,e.width,e.height;return[{}]},setCanvasWH:function(t){var e=t.bgObj,a=t.type,o=t.bgScale;console.log(e,a,o),i.poster=e}});case 5:a=e.sent,console.log("海报生成成功， 临时路径: "+a.poster.tempFilePath),i.poster.finalPath=a.poster.tempFilePath;case 8:i.qrShow=!0,e.next=16;break;case 11:e.prev=11,e.t0=e["catch"](1),i.$util.hideLoading(),i.$util.showToast(JSON.stringify(e.t0)),console.log(JSON.stringify(e.t0));case 16:case"end":return e.stop()}}),e,null,[[1,11]])})))()},saveImage:function(){var t=this;uni.saveImageToPhotosAlbum({filePath:t.poster.finalPath,success:function(e){t.$util.showToast("保存成功"),t.qrShow=!1},fail:function(e){t.$util.showToast("保存失败")}})},hideQr:function(){this.qrShow=!1}}};e.default=c},"0ca4":function(t,e,i){"use strict";i.r(e);var a=i("0bfd"),o=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,(function(){return a[t]}))}(n);e["default"]=o.a},2579:function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".header-wrap[data-v-fe117968]{width:100%;position:fixed;top:0;left:0;z-index:999}.header-wrap .index-header[data-v-fe117968]{height:%?176?%;padding:0 %?30?%;padding-top:%?100?%;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:center;font-size:%?40?%;position:relative}.header-wrap .index-header .back-icon[data-v-fe117968]{width:%?25?%;height:%?44?%;position:absolute;left:%?32?%;top:%?106?%}.hids[data-v-fe117968]{width:100%;height:100%;position:fixed;top:0;left:0;background-color:#000;opacity:.5;z-index:1000}.hids-main[data-v-fe117968]{width:%?520?%;height:%?800?%;position:fixed;top:12%;left:14%;background-color:#fff;z-index:1001}.hids-main .bgimg[data-v-fe117968]{width:%?520?%;height:%?800?%}.hids-main .codes[data-v-fe117968]{width:%?246?%;height:%?246?%;position:absolute;-webkit-transform:rotate(73deg);transform:rotate(73deg);top:%?360?%;left:%?138?%}.firstCanvas[data-v-fe117968]{position:fixed;top:-99999px}.btn-wrap[data-v-fe117968]{position:fixed;left:50%;top:80%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.code-bg[data-v-fe117968]{position:absolute;width:100%;height:calc(100% - %?176?%);top:%?176?%;left:0;z-index:-2}.code-wrap[data-v-fe117968]{position:absolute;left:10%;top:50%}.code-bg2[data-v-fe117968]{width:%?620?%;height:%?620?%;-webkit-transform:rotate(-16deg);transform:rotate(-16deg)}.share-wraps[data-v-fe117968]{width:100%;height:100%;position:absolute;top:0;left:0;border-top:%?2?% solid #f2f2f5;overflow:hidden}.share-wraps .code[data-v-fe117968]{position:absolute;top:%?78?%;left:%?126?%;width:%?314?%;height:%?314?%;-webkit-transform:rotate(73deg);transform:rotate(73deg)}.share-wraps .share-text[data-v-fe117968]{font-size:%?36?%;margin-top:%?30?%}.xiazai[data-v-fe117968]{width:%?42?%;height:%?42?%;position:fixed;top:%?104?%;right:%?30?%;z-index:999}.share-order[data-v-fe117968]{width:%?750?%;height:%?430?%;background-color:#fff;-webkit-border-top-left-radius:%?10?%;border-top-left-radius:%?10?%;-webkit-border-top-right-radius:%?10?%;border-top-right-radius:%?10?%;padding:%?100?% %?180?%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.share-order .share-item[data-v-fe117968]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.share-order .share-item uni-image[data-v-fe117968]{width:%?80?%;height:%?80?%;margin-bottom:%?20?%;margin-top:0}.sure-btn[data-v-fe117968]{width:100%;height:%?100?%;background:#fb4142;position:fixed;bottom:0;left:0;z-index:100;font-size:%?40?%;color:#fff;line-height:%?100?%;text-align:center}.hideCanvasView[data-v-fe117968]{position:relative}.hideCanvas[data-v-fe117968]{position:fixed;top:%?-99999?%;left:%?-99999?%;z-index:-99999}.flex_row_c_c[data-v-fe117968]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.modalView[data-v-fe117968]{width:100%;height:100%;position:fixed;top:0;left:0;right:0;bottom:0;opacity:0;outline:0;-webkit-transform:scale(3);transform:scale(3);-webkit-perspective:%?2500?%;perspective:%?2500?%;background:rgba(0,0,0,.6);-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:999}.modalView.show[data-v-fe117968]{opacity:1;-webkit-transform:scale(1);transform:scale(1);pointer-events:auto}.flex_column[data-v-fe117968]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.backgroundColor-white[data-v-fe117968]{background-color:#fff}.border_radius_10px[data-v-fe117968]{-webkit-border-radius:10px;border-radius:10px}.padding1vh[data-v-fe117968]{padding:1vh}.posterImage[data-v-fe117968]{width:60vw}.flex_row[data-v-fe117968]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.marginTop2vh[data-v-fe117968]{margin-top:2vh}",""]),t.exports=e},"7dd8":function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"header-wrap"},[i("v-uni-image",{staticClass:"xiazai",attrs:{src:"/static/xiazai.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showHids.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"index-header"},[t._v("分享推广"),i("v-uni-image",{staticClass:"back-icon",attrs:{src:"/static/back-black.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticClass:"share-wraps"},[i("v-uni-image",{staticClass:"code-bg",attrs:{src:t.imag+"share-image-bj.png"}}),i("v-uni-view",{staticClass:"code-wrap"},[i("v-uni-image",{staticClass:"code-bg2",attrs:{src:t.imag+"share-image-hz.png"}}),i("v-uni-image",{staticClass:"code",attrs:{src:t.codeImg}})],1)],1),i("v-uni-view",{staticClass:"flex_row_c_c modalView",class:t.qrShow?"show":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideQr()}}},[i("v-uni-view",{staticClass:"flex_column"},[i("v-uni-view",{staticClass:"backgroundColor-white padding1vh border_radius_10px"},[i("v-uni-image",{staticClass:"posterImage",attrs:{src:t.poster.finalPath,mode:"widthFix"}})],1),i("v-uni-view",{staticClass:"flex_row marginTop2vh"},[i("v-uni-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.saveImage()}}},[t._v("保存图片")])],1)],1)],1),i("v-uni-view",{staticClass:"hideCanvasView"},[i("v-uni-canvas",{staticClass:"hideCanvas",style:{width:(t.poster.width||0)+"px",height:(t.poster.height||0)+"px"},attrs:{"canvas-id":"default_PosterCanvasId"}})],1),i("QSPopup",{ref:"QSPopupShare",attrs:{type:"fadeInUp"}},[i("v-uni-view",{staticClass:"share-order disFlex"},[i("v-uni-view",{staticClass:"share-item"},[i("v-uni-image",{attrs:{src:"/static/wxfriend.png"}}),t._v("微信好友")],1),i("v-uni-view",{staticClass:"share-item"},[i("v-uni-image",{attrs:{src:"/static/friendcircle.png"}}),t._v("朋友圈")],1),i("v-uni-view",{staticClass:"sure-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hides("QSPopupShare")}}},[t._v("取消")])],1)],1),t.hids?i("v-uni-view",{staticClass:"hids",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hidsctx.apply(void 0,arguments)}}}):t._e(),t.hids?i("v-uni-view",{staticClass:"hids-main",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hidsctx.apply(void 0,arguments)}}},[i("v-uni-view",[i("v-uni-image",{staticClass:"bgimg",attrs:{src:t.imag+"15.jpg",mode:""}}),i("v-uni-image",{staticClass:"codes",attrs:{src:t.codeImg}})],1),i("v-uni-canvas",{staticClass:"firstCanvas",staticStyle:{width:"100%",height:"100%"},attrs:{"canvas-id":"firstCanvas"}}),i("v-uni-view",{staticClass:"btn-wrap"},[i("v-uni-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.shareF()}}},[t._v("保存图片")])],1)],1):t._e()],1)},n=[]},"80e4":function(t,e,i){var a=i("2579");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=i("4f06").default;o("c8755230",a,!0,{sourceMap:!1,shadowMode:!1})},"915a":function(t,e,i){"use strict";var a=i("80e4"),o=i.n(a);o.a},bc88:function(t,e,i){"use strict";i.r(e);var a=i("7dd8"),o=i("0ca4");for(var n in o)"default"!==n&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("915a");var s,r=i("f0c5"),d=Object(r["a"])(o["default"],a["b"],a["c"],!1,null,"fe117968",null,!1,a["a"],s);e["default"]=d.exports}}]);